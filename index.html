<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <title>hine.site</title>

    <link rel="stylesheet" type="text/css" href="./css/flyers.css" />
    <link rel="stylesheet" type="text/css" href="./css/locutus.css" />
    <link rel="stylesheet" type="text/css" href="./css/boom.css" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            box-sizing: border-box;
        }

        body {
            height: 100vh;
            background-color: #000;
        }

        .svg-background {
            width: 100%;
            height: 100vh;
            position: absolute;
            top: 0;
            object-position: center center;
            object-fit: cover;
        }

        img {
            -khtml-user-select: none;
            -o-user-select: none;
            -moz-user-select: none;
            -webkit-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body>
    <img id="locutus" class="locutus" draggable="false" src="./locutusofborg.webp">

    <svg class="svg-background">
        <defs>
            <radialGradient id="grad1" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                <stop offset="0%" style="stop-color:rgb(227, 16, 2);stop-opacity:1"/>
                <stop offset="1000%" style="stop-color:rgb(227, 16, 2);stop-opacity:0"/>
            </radialGradient>
        </defs>

        <circle id="circle" class="animate-fade" cx="569" cy="515" r="8" fill="url(#grad1)"/>
        <line id="laser" class="animate-fade" x1="0" y1="250" x2="569" y2="515" style="stroke:rgba(227, 16, 2, .3);stroke-width: 2"/>
    </svg>

    <div id="flyers"></div>

    <img id="comm-template" width="32px" draggable="false" src="./comm-01.webp">
    <div id="boombox-template" class="boombox">
        <div class="row">
            <div class="box"></div>
            <div class="box" style="background-color: #ff7d30;"></div>
            <div class="box" style="background-color: #d5d5d5;"></div>
            <div class="box" style="background-color: #d5d5d5;"></div>
            <div class="box" style="background-color: #ff7d30;"></div>
            <div class="box"></div>
        </div>
        <div class="row">
            <div class="box"></div>
            <div class="box"></div>
            <div class="box" style="background-color: #d5d5d5;"></div>
            <div class="box" style="background-color: #d5d5d5;"></div>
            <div class="box"></div>
            <div class="box"></div>
        </div>
        <div class="row">
            <div class="box"></div>
            <div class="box"></div>
            <div class="box" style="background-color: #cccccc;"></div>
            <div class="box" style="background-color: #cccccc;"></div>
            <div class="box"></div>
            <div class="box"></div>
        </div>
        <div class="row">
            <div class="box"></div>
            <div class="box" style="background-color: #d8c29e;"></div>
            <div class="box" style="background-color: #c6c6c6;"></div>
            <div class="box" style="background-color: #c6c6c6;"></div>
            <div class="box" style="background-color: #cfb595;"></div>
            <div class="box"></div>
        </div>
        <div class="row">
            <div class="box" style="background-color: #dfc9a7;"></div>
            <div class="box" style="background-color: #b9b0aa;"></div>
            <div class="box" style="background-color: #e95600;"></div>
            <div class="box" style="background-color: #e95600;"></div>
            <div class="box" style="background-color: #bab7af;"></div>
            <div class="box" style="background-color: #d2b390;"></div>
        </div>
        <div class="row">
            <div class="box" style="background-color: #896749;"></div>
            <div class="box" style="background-color: #acacac;"></div>
            <div class="box" style="background-color: #a19b96;"></div>
            <div class="box" style="background-color: #a19b96;"></div>
            <div class="box" style="background-color: #b8b9b4;"></div>
            <div class="box" style="background-color: #cdac8c;"></div>
        </div>
        <div class="row">
            <div class="box" style="background-color: #aa8a6c;"></div>
            <div class="box" style="background-color: #acacac;"></div>
            <div class="box" style="background-color: #8c6951;"></div>
            <div class="box" style="background-color: #8c6951;"></div>
            <div class="box" style="background-color: #afadad;"></div>
            <div class="box" style="background-color: #906e50;"></div>
        </div>
        <div class="row">
            <div class="box"></div>
            <div class="box" style="background-color: #9e9a99;"></div>
            <div class="box" style="background-color: #8c6951;"></div>
            <div class="box" style="background-color: #8c6951;"></div>
            <div class="box" style="background-color: #665c54;"></div>
            <div class="box"></div>
        </div>
        <div class="row">
            <div class="box" style="background-color: #ffc727;"></div>
            <div class="box" style="background-color: #949494;"></div>
            <div class="box" style="background-color: #866242;"></div>
            <div class="box" style="background-color: #866242;"></div>
            <div class="box" style="background-color: #dddddd;"></div>
            <div class="box" style="background-color: #ffc727;"></div>
        </div>
        <div class="row">
            <div class="box" style="background-color: #dddddd;"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box" style="background-color: #dddddd;"></div>
        </div>
    </div>

    <script src="./js/jquery.min.js"></script>
    <script type="module" src="./js/play.js"></script>

    <script type="text/javascript">
        ;(function ($) {
            $(function () {
                let locutus = $('#locutus').get(0);
                let viewport = $(window);
                let circle = $('#circle');
                let laser = $('#laser');

                let circleRadius = circle.attr('r');
                let circleX = circle.attr('cx');
                let circleY = circle.attr('cy');
                let laserX1 = laser.attr('x1');
                let laserY1 = laser.attr('y1');

                let backgroundWidth = locutus.naturalWidth;
                let backgroundHeight = locutus.naturalHeight;
                let backgroundRatio = (backgroundWidth / backgroundHeight);

                function updateSvgBackground() {
                    let viewportWidth = viewport.width();
                    let viewportHeight = viewport.height();
                    let viewportRatio = (viewportWidth / viewportHeight);

                    let currentWidth = 0;
                    let currentHeight = 0;

                    if (viewportRatio > backgroundRatio)
                    {
                        // Here the background's height is larger than the viewport's height.

                        currentWidth = viewportWidth;
                        currentHeight = (viewportWidth / backgroundRatio);
                    }
                    else
                    {
                        // Here the background's width is larger than the viewport's width.

                        currentWidth = (viewportHeight * backgroundRatio);
                        currentHeight = viewportHeight;
                    }

                    let scale = (currentWidth / backgroundWidth);

                    // The background image is centered in the viewport, so we need to calculate for that.
                    let offsetX = ((currentWidth - viewportWidth) * .5);
                    let offsetY = ((currentHeight - viewportHeight) * .5);

                    let cx = ((circleX * scale) - offsetX);
                    let cy = ((circleY * scale) - offsetY);
                    let r = (circleRadius * scale);
                    let lx1 = ((laserX1 * scale) - offsetX);
                    let ly1 = ((laserY1 * scale) - offsetY);

                    //console.log('viewport: ' + viewport.width() + 'x' + viewport.height() + ' | ' + viewportRatio);
                    //console.log('background: ' + backgroundWidth + 'x' + backgroundHeight + ' | ' + backgroundRatio);
                    //console.log('scale: ' + scale);
                    //console.log('offsetX: ' + offsetX);
                    //console.log('offsetY: ' + offsetY);
                    //console.log('cx: ' + cx);
                    //console.log('cy: ' + cy);
                    //console.log('r: ' + r);
                    //console.log('laserX1: ' + lx1);
                    //console.log('laserY1: ' + ly1);

                    circle.attr('cx',  cx);
                    circle.attr('cy', cy);
                    circle.attr('r', r);

                    laser.attr('x1',  lx1);
                    laser.attr('y1', ly1);
                    laser.attr('x2',  cx);
                    laser.attr('y2', cy);
                }

                updateSvgBackground();
                viewport.resize(function() {
                    updateSvgBackground();
                });
            });
        })(jQuery);
    </script>
</body>
</html>
